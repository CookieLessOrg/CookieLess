<!DOCTYPE html>
<html lang="ru">

<head>
    <meta charset="UTF-8">
    <title>Информация о вашем браузере</title>
    <style>
        body {
            background: #23272e;
            color: #fff;
            font-family: 'Segoe UI', Arial, sans-serif;
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            position: relative;
            max-width: 900px;
            margin: 36px auto;
            background: #23272e;
            border-radius: 16px;
            box-shadow: 0 8px 32px #0006;
            padding: 38px 18px 18px 18px;
        }

        h1 {
            text-align: center;
            margin-bottom: 24px;
            color: #4f8cff;
            font-size: 2em;
            font-weight: 700;
        }

        .blocks {
            display: flex;
            flex-wrap: wrap;
            gap: 18px;
            justify-content: space-between;
        }

        .block {
            background: #2a2f3a;
            border-radius: 12px;
            box-shadow: 0 2px 8px #0002;
            padding: 18px 18px 12px 18px;
            flex: 1 1 350px;
            min-width: 320px;
            margin-bottom: 0;
        }

        .block h2 {
            font-size: 1.13em;
            color: #7bb6ff;
            margin: 0 0 12px 0;
            font-weight: 600;
            letter-spacing: 0.5px;
        }

        .info-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .info-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.98em;
            padding: 5px 0;
            border-bottom: 1px solid #313543;
        }

        .info-list li:last-child {
            border-bottom: none;
        }

        .info-list .label {
            color: #4f8cff;
            font-weight: 500;
            min-width: 160px;
            margin-right: 10px;
        }

        .info-list .value {
            text-align: right;
            word-break: break-all;
            color: #fff;
        }

        .btn-group {
            display: flex;
            justify-content: center;
            gap: 18px;
            margin: 28px 0 28px 0;
        }

        .btn {
            background: #4f8cff;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 12px 28px;
            font-size: 1.08em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px #0002;
            transition: background 0.2s, transform 0.1s;
        }

        .btn:hover {
            background: #3570d4;
            transform: translateY(-2px) scale(1.03);
        }

        .server-data {
            margin-top: 24px;
            background: #23272e;
            border-radius: 8px;
            padding: 14px 16px;
            color: #b3e5ff;
            font-size: 1em;
            word-break: break-all;
            box-shadow: 0 2px 8px #0002;
        }

        #map {
            width: 100%;
            height: 320px;
            border-radius: 10px;
            margin-top: 18px;
            display: none;
        }

        @media (max-width: 1100px) {
            .blocks {
                flex-direction: column;
                gap: 0;
            }

            .block {
                min-width: 0;
                margin-bottom: 18px;
            }
        }

        @media (max-width: 600px) {
            .container {
                padding: 8px 2vw;
            }

            .block {
                padding: 10px 6px 6px 6px;
            }

            .info-list .label {
                min-width: 90px;
            }
        }





        .stats-images {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 10px;
        }

        .stats-thumb {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: 6px;
            cursor: pointer;
            border: 2px solid #4f8cff22;
            transition: box-shadow 0.2s, border 0.2s;
        }

        .stats-thumb:hover {
            box-shadow: 0 0 8px #4f8cff88;
            border: 2px solid #4f8cff;
        }

        .img-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            right: 0;
            bottom: 0;
            background: rgba(20, 30, 50, 0.92);
            justify-content: center;
            align-items: center;
        }

        .img-modal img {
            max-width: 90vw;
            max-height: 90vh;
            border-radius: 12px;
            box-shadow: 0 0 24px #000a;
            background: #fff;
        }

        .img-modal.active {
            display: flex;
        }


        .lang-switch {
            position: absolute;
            top: 18px;
            right: 24px;
            margin-left: 0;
            display: block;
            background: #4f8cff;
            color: #fff;
            border: none;
            border-radius: 8px;
            padding: 8px 18px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            box-shadow: 0 2px 8px #0002;
            transition: background 0.2s, transform 0.1s;
        }

        .lang-switch:hover {
            background: #3570d4;
            transform: translateY(-2px) scale(1.03);
        }

        #fast-stats-block {
            margin-top: 18px;
        }
    </style>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
</head>

<body>
    <div class="container">
        <button id="lang-switch" class="lang-switch">English</button>
        <h1>CookieLess: Статистика о вашей системе без куки</h1>
        <div class="blocks">
            <div class="block">
                <h2>Браузер и система</h2>
                <ul class="info-list">
                    <li><span class="label">User Agent</span><span class="value" id="userAgent"></span></li>
                    <li><span class="label">Название/версия браузера</span><span class="value" id="browserName"></span>
                    </li>
                    <li><span class="label">Движок/версия</span><span class="value" id="engine"></span></li>
                    <li><span class="label">ОС/платформа</span><span class="value" id="platform"></span></li>
                    <li><span class="label">Архитектура</span><span class="value" id="arch"></span></li>
                    <li><span class="label">Язык</span><span class="value" id="language"></span></li>
                    <li><span class="label">Мобильность</span><span class="value" id="isMobile"></span></li>
                    <li><span class="label">Сенсорный экран</span><span class="value" id="isTouch"></span></li>
                    <li><span class="label">JavaScript</span><span class="value" id="jsEnabled"></span></li>
                    <li><span class="label">SVG</span><span class="value" id="svg"></span></li>
                    <li><span class="label">WebP</span><span class="value" id="webp"></span></li>
                    <li><span class="label">История</span><span class="value" id="history"></span></li>
                    <li><span class="label">localStorage</span><span class="value" id="localStorage"></span></li>
                    <li><span class="label">postMessage</span><span class="value" id="postMessage"></span></li>
                    <li><span class="label">SameSite</span><span class="value" id="sameSite"></span></li>
                    <li><span class="label">CSP1/CSP2</span><span class="value" id="csp"></span></li>
                </ul>
            </div>
            <div class="block">
                <h2>Экран и графика</h2>
                <ul class="info-list">
                    <li><span class="label">Размер экрана</span><span class="value" id="screen"></span></li>
                    <li><span class="label">Доступная область</span><span class="value" id="availScreen"></span></li>
                    <li><span class="label">Глубина цвета</span><span class="value" id="colorDepth"></span></li>
                    <li><span class="label">Глубина пикселя</span><span class="value" id="pixelDepth"></span></li>
                    <li><span class="label">GPU</span><span class="value" id="gpu"></span></li>
                </ul>
            </div>
            <div class="block">
                <h2>Сеть и местоположение</h2>
                <ul class="info-list">
                    <li><span class="label">IP-адрес</span><span class="value" id="ip"></span></li>
                    <li><span class="label">Геолокация</span><span class="value" id="geo"></span></li>
                    <li><span class="label">Точность (lat,lon)</span><span class="value" id="geoAccuracy"></span></li>
                    <li><span class="label">Провайдер</span><span class="value" id="provider"></span></li>
                    <li><span class="label">Время/часовой пояс</span><span class="value" id="timezone"></span></li>
                    <li><span class="label">IPv6</span><span class="value" id="ipv6"></span></li>
                </ul>
                <button class="btn" id="showMapBtn" style="margin-top:10px;">Показать карту</button>
                <div id="map"></div>
            </div>
            <div class="block">
                <h2>Cookie, хранение и прочее</h2>
                <ul class="info-list">
                    <li><span class="label">Cookie</span><span class="value" id="cookie"></span></li>
                    <li><span class="label">persistent-storage</span><span class="value" id="persistentStorage"></span>
                    </li>
                    <li><span class="label">Принимаемые типы</span><span class="value" id="accept"></span></li>
                    <li><span class="label">Кодировки</span><span class="value" id="acceptEncoding"></span></li>
                    <li><span class="label">Java</span><span class="value" id="javaEnabled"></span></li>
                    <li><span class="label">Do Not Track</span><span class="value" id="dnt"></span></li>
                    <li><span class="label">sendBeacon</span><span class="value" id="sendBeacon"></span></li>
                    <li><span class="label">getUserMedia</span><span class="value" id="getUserMedia"></span></li>
                    <li><span class="label">Заряд батареи</span><span class="value" id="battery"></span></li>
                    <li><span class="label">Объём памяти</span><span class="value" id="deviceMemory"></span></li>
                </ul>
            </div>
            <div class="block">
                <h2>Плагины, медиа и разрешения</h2>
                <ul class="info-list">
                    <li><span class="label">Плагины</span><span class="value" id="plugins"></span></li>
                    <li><span class="label">Медиаустройства</span><span class="value" id="mediaDevices"></span></li>
                    <li><span class="label">Видео/аудио</span><span class="value" id="mediaSupport"></span></li>
                    <li><span class="label">Разрешения</span><span class="value" id="permissions"></span></li>
                </ul>
            </div>
        </div>
        <div class="server-data" id="serverData" style="display:none"></div>




        <div class="block" id="fast-stats-block">
            <h2>Быстрая статистика</h2>
            <ul class="info-list" id="fastStatsList">
                <li><span class="label">За сутки</span><span class="value" id="fastDay"></span></li>
                <li><span class="label">За месяц</span><span class="value" id="fastMonth"></span></li>
                <li><span class="label">За всё время</span><span class="value" id="fastAll"></span></li>
            </ul>
        </div>
        <div class="block" id="stats-images-block" style="margin-top: 18px;">
            <h2>Графики всякие (изменить название)</h2>

            <div class="stats-images">
                <img class="stats-thumb" src="https://cookielessapi.3192693-wd09907.twc1.net:7881/stats1.png"
                    alt="Статистика 1"
                    onerror="this.src='https://staticg.sportskeeda.com/editor/2025/04/1b22c-17442958800623-1920.jpg'">
                <img class="stats-thumb" src="https://cookielessapi.3192693-wd09907.twc1.net:7881/stats2.png"
                    alt="Статистика 2"
                    onerror="this.src='https://staticg.sportskeeda.com/editor/2025/04/1b22c-17442958800623-1920.jpg'">
                <img class="stats-thumb" src="https://cookielessapi.3192693-wd09907.twc1.net:7881/stats3.png"
                    alt="Статистика 3"
                    onerror="this.src='https://staticg.sportskeeda.com/editor/2025/04/1b22c-17442958800623-1920.jpg'">
                <img class="stats-thumb" src="https://cookielessapi.3192693-wd09907.twc1.net:7881/stats4.png"
                    alt="Статистика 4"
                    onerror="this.src='https://staticg.sportskeeda.com/editor/2025/04/1b22c-17442958800623-1920.jpg'">
                <img class="stats-thumb" src="https://cookielessapi.3192693-wd09907.twc1.net:7881/stats5.png"
                    alt="Статистика 5"
                    onerror="this.src='https://staticg.sportskeeda.com/editor/2025/04/1b22c-17442958800623-1920.jpg'">
            </div>
            <div id="img-modal" class="img-modal" onclick="closeImgModal()">
                <img id="img-modal-img" src="" alt="Увеличенное изображение">
            </div>
        </div>

    </div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        let collectedData = {};
        let geoCoords = null;

        async function updateInfo() {
            // IP, геолокация, провайдер
            let ip = 'Ошибка', geo = 'Ошибка', geoAccuracy = '—', provider = '—';
            collectedData.ip = ip;
            collectedData.geo = geo;
            collectedData.geoAccuracy = geoAccuracy;
            collectedData.provider = provider;
            try {
                let ipinfo = await fetch('https://ipapi.co/json/').then(r => r.json());
                ip = ipinfo.ip || '—';
                geo = (ipinfo.country_name || '') + (ipinfo.city ? ', ' + ipinfo.city : '');
                geoAccuracy = ipinfo.latitude && ipinfo.longitude ? `${ipinfo.latitude}, ${ipinfo.longitude}` : '—';
                provider = ipinfo.org || '—';
                geoCoords = ipinfo.latitude && ipinfo.longitude ? [ipinfo.latitude, ipinfo.longitude] : null;
                collectedData.ip = ip;
                collectedData.geo = geo;
                collectedData.geoAccuracy = geoAccuracy;
                collectedData.provider = provider;
            } catch (e) {
                try {
                    let ipinfo = await fetch('https://api.ipify.org?format=json').then(r => r.json());
                    ip = ipinfo.ip || '—';
                    geo = (ipinfo.country_name || '') + (ipinfo.city ? ', ' + ipinfo.city : '');
                    geoAccuracy = ipinfo.latitude && ipinfo.longitude ? `${ipinfo.latitude}, ${ipinfo.longitude}` : '—';
                    provider = ipinfo.org || '—';
                    geoCoords = ipinfo.latitude && ipinfo.longitude ? [ipinfo.latitude, ipinfo.longitude] : null;
                    collectedData.ip = ip;
                    collectedData.geo = geo;
                    collectedData.geoAccuracy = geoAccuracy;
                    collectedData.provider = provider;
                }
                catch (e) {
                    collectedData.ip = ip;
                    collectedData.geo = geo;
                    collectedData.geoAccuracy = geoAccuracy;
                    collectedData.provider = provider;
                }
            }
            document.getElementById('ip').textContent = ip;
            document.getElementById('geo').textContent = geo;
            document.getElementById('geoAccuracy').textContent = geoAccuracy;
            document.getElementById('provider').textContent = provider;

            // Cookie
            let cookie = navigator.cookieEnabled ? 'Да' : 'Нет';
            document.getElementById('cookie').textContent = cookie;
            collectedData.cookieEnabled = cookie;

            // localStorage
            let ls = 'Нет';
            try {
                localStorage.setItem('test', '1');
                if (localStorage.getItem('test') === '1') {
                    ls = 'Да';
                    localStorage.removeItem('test');
                }
            } catch (e) { }
            document.getElementById('localStorage').textContent = ls;
            collectedData.localStorage = ls;

            // persistent-storage
            let persistent = 'Нет';
            if (navigator.storage && navigator.storage.persisted) {
                persistent = await navigator.storage.persisted().then(v => v ? 'Да' : 'Нет').catch(() => 'Нет');
            }
            document.getElementById('persistentStorage').textContent = persistent;
            collectedData.persistentStorage = persistent;

            // User Agent
            document.getElementById('userAgent').textContent = navigator.userAgent;
            collectedData.userAgent = navigator.userAgent;

            // Язык браузера
            let lang = navigator.language || (navigator.languages && navigator.languages[0]) || '—';
            document.getElementById('language').textContent = lang;
            collectedData.language = lang;

            // Название и версия браузера (простая эвристика)
            let browserName = 'Не определено', browserVersion = '';
            let ua = navigator.userAgent;
            if (/YaBrowser/.test(ua)) {
                browserName = 'Yandex Browser';
                browserVersion = ua.match(/YaBrowser\/([\d.]+)/)?.[1] || '';
            } else if (/Chrome/.test(ua)) {
                browserName = 'Chrome';
                browserVersion = ua.match(/Chrome\/([\d.]+)/)?.[1] || '';
            } else if (/Firefox/.test(ua)) {
                browserName = 'Firefox';
                browserVersion = ua.match(/Firefox\/([\d.]+)/)?.[1] || '';
            } else if (/Safari/.test(ua)) {
                browserName = 'Safari';
                browserVersion = ua.match(/Version\/([\d.]+)/)?.[1] || '';
            } else if (/Edge/.test(ua)) {
                browserName = 'Edge';
                browserVersion = ua.match(/Edge\/([\d.]+)/)?.[1] || '';
            }
            document.getElementById('browserName').textContent = browserName + (browserVersion ? ' ' + browserVersion : '');
            collectedData.browserName = browserName;
            collectedData.browserVersion = browserVersion;

            // Движок браузера и версия
            let engine = 'Не определено', engineVersion = '';
            if (/AppleWebKit/.test(ua)) {
                engine = 'WebKit';
                engineVersion = ua.match(/AppleWebKit\/([\d.]+)/)?.[1] || '';
            } else if (/Gecko/.test(ua)) {
                engine = 'Gecko';
                engineVersion = ua.match(/rv:([\d.]+)/)?.[1] || '';
            }
            document.getElementById('engine').textContent = engine + (engineVersion ? ' ' + engineVersion : '');
            collectedData.engine = engine;
            collectedData.engineVersion = engineVersion;

            // ОС и платформа
            document.getElementById('platform').textContent = navigator.platform;
            collectedData.platform = navigator.platform;

            // Архитектура
            let arch = navigator.userAgent.includes('x64') || navigator.platform.includes('64') ? 'x64' : 'x86/ARM';
            document.getElementById('arch').textContent = arch;
            collectedData.arch = arch;

            // Мобильное устройство
            let isMobile = /Android|iPhone|iPad|iPod|Mobile|Windows Phone/i.test(ua) ? 'Да' : 'Нет';
            document.getElementById('isMobile').textContent = isMobile;
            collectedData.isMobile = isMobile;

            // Сенсорный экран
            let isTouch = 'Нет';
            if ('ontouchstart' in window || navigator.maxTouchPoints > 0) isTouch = 'Да';
            document.getElementById('isTouch').textContent = isTouch;
            collectedData.isTouch = isTouch;

            // JavaScript
            document.getElementById('jsEnabled').textContent = 'Да';
            collectedData.jsEnabled = 'Да';

            // SVG поддержка
            let svgSupport = !!document.createElementNS &&
                !!document.createElementNS('http://www.w3.org/2000/svg', 'svg').createSVGRect ? 'Да' : 'Нет';
            document.getElementById('svg').textContent = svgSupport;
            collectedData.svg = svgSupport;

            // WebP поддержка
            function checkWebP(cb) {
                let img = new Image();
                img.onload = () => cb(img.width === 1);
                img.onerror = () => cb(false);
                img.src = "data:image/webp;base64,UklGRiIAAABXRUJQVlA4TAYAAAAvAAAAAAfQ//73v/+BiOh/AAA=";
            }
            checkWebP(supported => {
                document.getElementById('webp').textContent = supported ? 'Да' : 'Нет';
                collectedData.webp = supported ? 'Да' : 'Нет';
            });

            // История
            let historySupport = !!window.history && typeof window.history.pushState === 'function' ? 'Да' : 'Нет';
            document.getElementById('history').textContent = historySupport;
            collectedData.history = historySupport;

            // postMessage
            let postMessageSupport = !!window.postMessage ? 'Да' : 'Нет';
            document.getElementById('postMessage').textContent = postMessageSupport;
            collectedData.postMessage = postMessageSupport;

            // SameSite
            let sameSiteSupport = (function () {
                try {
                    document.cookie = "samesite_test=1; SameSite=Strict";
                    return document.cookie.indexOf("samesite_test") !== -1 ? 'Да' : 'Нет';
                } catch (e) { return 'Нет'; }
            })();
            document.getElementById('sameSite').textContent = sameSiteSupport;
            collectedData.sameSite = sameSiteSupport;

            // CSP1/CSP2
            let csp1 = typeof window.SecurityPolicyViolationEvent !== "undefined" ? 'Да' : 'Нет';
            let csp2 = typeof window.ReportingObserver !== "undefined" ? 'Да' : 'Нет';
            document.getElementById('csp').textContent = csp1 + '/' + csp2;
            collectedData.csp = csp1 + '/' + csp2;

            // Размер экрана
            let screenSize = `${screen.width} x ${screen.height}`;
            document.getElementById('screen').textContent = screenSize;
            collectedData.screen = screenSize;

            // Доступная область экрана
            let availScreen = `${screen.availWidth} x ${screen.availHeight}`;
            document.getElementById('availScreen').textContent = availScreen;
            collectedData.availScreen = availScreen;

            // Глубина цвета
            let colorDepth = `${screen.colorDepth} бит`;
            document.getElementById('colorDepth').textContent = colorDepth;
            collectedData.colorDepth = colorDepth;

            // Глубина пикселя
            let pixelDepth = `${screen.pixelDepth} бит`;
            document.getElementById('pixelDepth').textContent = pixelDepth;
            collectedData.pixelDepth = pixelDepth;

            // GPU-информация
            let canvas = document.createElement('canvas');
            let gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            let gpu = '—';
            if (gl) {
                let debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    gpu = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) + ' / ' +
                        gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                } else {
                    gpu = gl.getParameter(gl.RENDERER);
                }
            }
            document.getElementById('gpu').textContent = gpu;
            collectedData.gpu = gpu;

            // IPv6 поддержка
            let ipv6 = '—';
            try {
                fetch('https://ipv6.icanhazip.com/', { method: 'GET', mode: 'cors' })
                    .then(r => r.text())
                    .then(ipv6addr => {
                        ipv6 = ipv6addr.trim() ? 'Да' : 'Нет';
                        document.getElementById('ipv6').textContent = ipv6;
                        collectedData.ipv6 = ipv6;
                    }).catch(() => { document.getElementById('ipv6').textContent = 'Нет'; collectedData.ipv6 = 'Нет'; });
            } catch (e) {
                document.getElementById('ipv6').textContent = 'Нет';
                collectedData.ipv6 = 'Нет';
            }

            // Заряд батареи
            let batteryStr = '—';
            if (navigator.getBattery) {
                navigator.getBattery().then(bat => {
                    batteryStr = `Заряд: ${Math.round(bat.level * 100)}%${bat.charging ? ', Заряжается' : ''}`;
                    document.getElementById('battery').textContent = batteryStr;
                    collectedData.battery = batteryStr;
                });
            } else {
                document.getElementById('battery').textContent = 'Нет данных';
                collectedData.battery = 'Нет данных';
            }

            // Объем памяти устройства
            let deviceMemory = navigator.deviceMemory ? navigator.deviceMemory + ' ГБ' : '—';
            document.getElementById('deviceMemory').textContent = deviceMemory;
            collectedData.deviceMemory = deviceMemory;

            // Принимаемые типы документов
            let accept = navigator.userAgent.includes('Chrome') ? 'text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7' : '—';
            document.getElementById('accept').textContent = accept;
            collectedData.accept = accept;

            // Принимаемые кодировки
            let acceptEncoding = 'gzip, deflate, br, zstd';
            document.getElementById('acceptEncoding').textContent = acceptEncoding;
            collectedData.acceptEncoding = acceptEncoding;

            // Java включён/выключен
            let javaEnabled = navigator.javaEnabled ? (navigator.javaEnabled() ? 'Да' : 'Нет') : 'Нет';
            document.getElementById('javaEnabled').textContent = javaEnabled;
            collectedData.javaEnabled = javaEnabled;

            // Do Not Track
            let dnt = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
            let dntVal = (dnt === "1" || dnt === "yes") ? 'Включено' : 'Отключено';
            document.getElementById('dnt').textContent = dntVal;
            collectedData.dnt = dntVal;

            // sendBeacon
            let sendBeacon = typeof navigator.sendBeacon === 'function' ? 'Да' : 'Нет';
            document.getElementById('sendBeacon').textContent = sendBeacon;
            collectedData.sendBeacon = sendBeacon;

            // getUserMedia
            let getUserMedia = !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) ? 'Да' : 'Нет';
            document.getElementById('getUserMedia').textContent = getUserMedia;
            collectedData.getUserMedia = getUserMedia;

            // Поддержка видео/аудио
            let mediaSupport = [];
            let v = document.createElement('video');
            let a = document.createElement('audio');
            if (v.canPlayType) {
                if (v.canPlayType('video/mp4')) mediaSupport.push('MP4');
                if (v.canPlayType('video/webm')) mediaSupport.push('WebM');
                if (v.canPlayType('video/ogg')) mediaSupport.push('Ogg');
            }
            if (a.canPlayType) {
                if (a.canPlayType('audio/aac')) mediaSupport.push('AAC');
                if (a.canPlayType('audio/ogg')) mediaSupport.push('OGG');
                if (a.canPlayType('audio/flac')) mediaSupport.push('FLAC');
                if (a.canPlayType('audio/mp3')) mediaSupport.push('MP3');
            }
            document.getElementById('mediaSupport').textContent = mediaSupport.join(', ') || '—';
            collectedData.mediaSupport = mediaSupport;

            // Плагины
            let plugins = [];
            if (navigator.plugins && navigator.plugins.length) {
                for (let i = 0; i < navigator.plugins.length; i++) {
                    let p = navigator.plugins[i];
                    plugins.push(`${p.name}::${p.description}::${p.filename}`);
                }
            } else {
                plugins = ['Нет данных или не поддерживается'];
            }
            document.getElementById('plugins').textContent = plugins.join('; ');
            collectedData.plugins = plugins;

            // Медиаустройства
            let mediaDevicesStr = '—';
            let multimediaDevices = {};
            if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
                try {
                    let devices = await navigator.mediaDevices.enumerateDevices();
                    let speakers = devices.filter(d => d.kind === 'audiooutput').length;
                    let micros = devices.filter(d => d.kind === 'audioinput').length;
                    let webcams = devices.filter(d => d.kind === 'videoinput').length;
                    mediaDevicesStr = `Динамики: ${speakers}, Микрофоны: ${micros}, Камеры: ${webcams}`;
                    multimediaDevices = { speakers, micros, webcams };
                } catch (e) {
                    mediaDevicesStr = 'Ошибка';
                }
            }
            document.getElementById('mediaDevices').textContent = mediaDevicesStr;
            collectedData.multimediaDevices = multimediaDevices;

            // Разрешения браузера
            let permissionsStr = [];
            if (navigator.permissions && navigator.permissions.query) {
                let perms = [
                    'geolocation', 'notifications', 'midi', 'camera', 'microphone',
                    'background-sync', 'persistent-storage', 'accelerometer', 'gyroscope',
                    'magnetometer', 'clipboard-read', 'clipboard-write', 'payment-handler'
                ];
                for (let perm of perms) {
                    try {
                        let res = await navigator.permissions.query({ name: perm });
                        permissionsStr.push(`${perm}: ${res.state}`);
                    } catch (e) {
                        // не поддерживается
                    }
                }
            } else {
                permissionsStr = ['Не поддерживается'];
            }
            document.getElementById('permissions').textContent = permissionsStr.join('; ');
            collectedData.permissions = permissionsStr;

            // Время и часовой пояс
            const tz = Intl.DateTimeFormat().resolvedOptions().timeZone;
            const offset = -new Date().getTimezoneOffset() / 60;
            let tzStr = `${tz} (UTC${offset >= 0 ? '+' : ''}${offset})`;
            document.getElementById('timezone').textContent = tzStr;
            collectedData.timezone = tzStr;
        }




        async function updateInfo() {
            // IP, геолокация, провайдер
            let ip = 'Ошибка', geo = 'Ошибка', geoAccuracy = '—', provider = '—';
            collectedData.ip = ip;
            collectedData.geo = geo;
            collectedData.geoAccuracy = geoAccuracy;
            collectedData.provider = provider;
            try {
                let ipinfo = await fetch('https://ipapi.co/json/').then(r => r.json());
                ip = ipinfo.ip || '—';
                geo = (ipinfo.country_name || '') + (ipinfo.city ? ', ' + ipinfo.city : '');
                geoAccuracy = ipinfo.latitude && ipinfo.longitude ? `${ipinfo.latitude}, ${ipinfo.longitude}` : '—';
                provider = ipinfo.org || '—';
                geoCoords = ipinfo.latitude && ipinfo.longitude ? [ipinfo.latitude, ipinfo.longitude] : null;
                collectedData.ip = ip;
                collectedData.geo = geo;
                collectedData.geoAccuracy = geoAccuracy;
                collectedData.provider = provider;
            } catch (e) {
                try {
                    let ipinfo = await fetch('https://api.ipify.org?format=json').then(r => r.json());
                    ip = ipinfo.ip || '—';
                    geo = (ipinfo.country_name || '') + (ipinfo.city ? ', ' + ipinfo.city : '');
                    geoAccuracy = ipinfo.latitude && ipinfo.longitude ? `${ipinfo.latitude}, ${ipinfo.longitude}` : '—';
                    provider = ipinfo.org || '—';
                    geoCoords = ipinfo.latitude && ipinfo.longitude ? [ipinfo.latitude, ipinfo.longitude] : null;
                    collectedData.ip = ip;
                    collectedData.geo = geo;
                    collectedData.geoAccuracy = geoAccuracy;
                    collectedData.provider = provider;
                }
                catch (e) {
                    collectedData.ip = ip;
                    collectedData.geo = geo;
                    collectedData.geoAccuracy = geoAccuracy;
                    collectedData.provider = provider;
                }
            }
            document.getElementById('ip').textContent = ip;
            document.getElementById('ip').setAttribute('data-orig-value', ip);
            document.getElementById('geo').textContent = geo;
            document.getElementById('geo').setAttribute('data-orig-value', geo);
            document.getElementById('geoAccuracy').textContent = geoAccuracy;
            document.getElementById('geoAccuracy').setAttribute('data-orig-value', geoAccuracy);
            document.getElementById('provider').textContent = provider;
            document.getElementById('provider').setAttribute('data-orig-value', provider);

            // Cookie
            let cookie = navigator.cookieEnabled ? 'Да' : 'Нет';
            document.getElementById('cookie').textContent = cookie;
            document.getElementById('cookie').setAttribute('data-orig-value', cookie);
            collectedData.cookieEnabled = cookie;

            // localStorage
            let ls = 'Нет';
            try {
                localStorage.setItem('test', '1');
                if (localStorage.getItem('test') === '1') {
                    ls = 'Да';
                    localStorage.removeItem('test');
                }
            } catch (e) { }
            document.getElementById('localStorage').textContent = ls;
            document.getElementById('localStorage').setAttribute('data-orig-value', ls);
            collectedData.localStorage = ls;

            // persistent-storage
            let persistent = 'Нет';
            if (navigator.storage && navigator.storage.persisted) {
                persistent = await navigator.storage.persisted().then(v => v ? 'Да' : 'Нет').catch(() => 'Нет');
            }
            document.getElementById('persistentStorage').textContent = persistent;
            document.getElementById('persistentStorage').setAttribute('data-orig-value', persistent);
            collectedData.persistentStorage = persistent;

            // User Agent
            document.getElementById('userAgent').textContent = navigator.userAgent;
            document.getElementById('userAgent').setAttribute('data-orig-value', navigator.userAgent);
            collectedData.userAgent = navigator.userAgent;

            // Язык браузера
            let lang = navigator.language || (navigator.languages && navigator.languages[0]) || '—';
            document.getElementById('language').textContent = lang;
            document.getElementById('language').setAttribute('data-orig-value', lang);
            collectedData.language = lang;

            // Название и версия браузера (простая эвристика)
            let browserName = 'Не определено', browserVersion = '';
            let ua = navigator.userAgent;
            if (/YaBrowser/.test(ua)) {
                browserName = 'Yandex Browser';
                browserVersion = ua.match(/YaBrowser\/([\d.]+)/)?.[1] || '';
            } else if (/Chrome/.test(ua)) {
                browserName = 'Chrome';
                browserVersion = ua.match(/Chrome\/([\d.]+)/)?.[1] || '';
            } else if (/Firefox/.test(ua)) {
                browserName = 'Firefox';
                browserVersion = ua.match(/Firefox\/([\d.]+)/)?.[1] || '';
            } else if (/Safari/.test(ua)) {
                browserName = 'Safari';
                browserVersion = ua.match(/Version\/([\d.]+)/)?.[1] || '';
            } else if (/Edge/.test(ua)) {
                browserName = 'Edge';
                browserVersion = ua.match(/Edge\/([\d.]+)/)?.[1] || '';
            }
            let browserNameFull = browserName + (browserVersion ? ' ' + browserVersion : '');
            document.getElementById('browserName').textContent = browserNameFull;
            document.getElementById('browserName').setAttribute('data-orig-value', browserNameFull);
            collectedData.browserName = browserName;
            collectedData.browserVersion = browserVersion;

            // Движок браузера и версия
            let engine = 'Не определено', engineVersion = '';
            if (/AppleWebKit/.test(ua)) {
                engine = 'WebKit';
                engineVersion = ua.match(/AppleWebKit\/([\d.]+)/)?.[1] || '';
            } else if (/Gecko/.test(ua)) {
                engine = 'Gecko';
                engineVersion = ua.match(/rv:([\d.]+)/)?.[1] || '';
            }
            let engineFull = engine + (engineVersion ? ' ' + engineVersion : '');
            document.getElementById('engine').textContent = engineFull;
            document.getElementById('engine').setAttribute('data-orig-value', engineFull);
            collectedData.engine = engine;
            collectedData.engineVersion = engineVersion;

            // ОС и платформа
            document.getElementById('platform').textContent = navigator.platform;
            document.getElementById('platform').setAttribute('data-orig-value', navigator.platform);
            collectedData.platform = navigator.platform;

            // Архитектура
            let arch = navigator.userAgent.includes('x64') || navigator.platform.includes('64') ? 'x64' : 'x86/ARM';
            document.getElementById('arch').textContent = arch;
            document.getElementById('arch').setAttribute('data-orig-value', arch);
            collectedData.arch = arch;

            // Мобильное устройство
            let isMobile = /Android|iPhone|iPad|iPod|Opera Mini|IEMobile|WPDesktop|Mobile/i.test(ua) ? 'Да' : 'Нет';
            document.getElementById('isMobile').textContent = isMobile;
            document.getElementById('isMobile').setAttribute('data-orig-value', isMobile);
            collectedData.isMobile = isMobile;

            // Сенсорный экран
            let isTouch = ('ontouchstart' in window) || (navigator.maxTouchPoints > 0) ? 'Да' : 'Нет';
            document.getElementById('isTouch').textContent = isTouch;
            document.getElementById('isTouch').setAttribute('data-orig-value', isTouch);
            collectedData.isTouch = isTouch;

            // JavaScript
            let jsEnabled = 'Да';
            document.getElementById('jsEnabled').textContent = jsEnabled;
            document.getElementById('jsEnabled').setAttribute('data-orig-value', jsEnabled);
            collectedData.jsEnabled = jsEnabled;

            // SVG
            let svg = !!document.createElementNS && !!document.createElementNS('http://www.w3.org/2000/svg', 'svg').createSVGRect ? 'Да' : 'Нет';
            document.getElementById('svg').textContent = svg;
            document.getElementById('svg').setAttribute('data-orig-value', svg);
            collectedData.svg = svg;

            // WebP
            let webp = 'Нет';
            try {
                let img = new Image();
                img.onload = img.onerror = function () {
                    webp = (img.height === 2) ? 'Да' : 'Нет';
                    document.getElementById('webp').textContent = webp;
                    document.getElementById('webp').setAttribute('data-orig-value', webp);
                    collectedData.webp = webp;
                };
                img.src = "data:image/webp;base64,UklGRiIAAABXRUJQVlA4TBEAAAAvAAAAAAfQ//73v/+BiOh/AAA=";
            } catch (e) {
                document.getElementById('webp').textContent = webp;
                document.getElementById('webp').setAttribute('data-orig-value', webp);
                collectedData.webp = webp;
            }

            // История
            let historySupport = !!window.history ? 'Да' : 'Нет';
            document.getElementById('history').textContent = historySupport;
            document.getElementById('history').setAttribute('data-orig-value', historySupport);
            collectedData.history = historySupport;

            // postMessage
            let postMessage = !!window.postMessage ? 'Да' : 'Нет';
            document.getElementById('postMessage').textContent = postMessage;
            document.getElementById('postMessage').setAttribute('data-orig-value', postMessage);
            collectedData.postMessage = postMessage;

            // SameSite
            let sameSite = 'Нет';
            try {
                document.cookie = "samesite_test=1; SameSite=Strict";
                sameSite = document.cookie.indexOf("samesite_test") !== -1 ? 'Да' : 'Нет';
            } catch (e) { }
            document.getElementById('sameSite').textContent = sameSite;
            document.getElementById('sameSite').setAttribute('data-orig-value', sameSite);
            collectedData.sameSite = sameSite;

            // CSP
            let csp = 'Нет';
            if ('securitypolicy' in document) csp = 'Да';
            document.getElementById('csp').textContent = csp;
            document.getElementById('csp').setAttribute('data-orig-value', csp);
            collectedData.csp = csp;

            // Экран и графика
            let screenSize = `${window.screen.width} x ${window.screen.height}`;
            document.getElementById('screen').textContent = screenSize;
            document.getElementById('screen').setAttribute('data-orig-value', screenSize);
            collectedData.screen = screenSize;

            let availScreen = `${window.screen.availWidth} x ${window.screen.availHeight}`;
            document.getElementById('availScreen').textContent = availScreen;
            document.getElementById('availScreen').setAttribute('data-orig-value', availScreen);
            collectedData.availScreen = availScreen;

            let colorDepth = window.screen.colorDepth || '—';
            document.getElementById('colorDepth').textContent = colorDepth;
            document.getElementById('colorDepth').setAttribute('data-orig-value', colorDepth);
            collectedData.colorDepth = colorDepth;

            let pixelDepth = window.screen.pixelDepth || '—';
            document.getElementById('pixelDepth').textContent = pixelDepth;
            document.getElementById('pixelDepth').setAttribute('data-orig-value', pixelDepth);
            collectedData.pixelDepth = pixelDepth;

            // GPU (WebGL)
            let gpu = '—';
            try {
                let canvas = document.createElement('canvas');
                let gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (gl) {
                    let debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    if (debugInfo) {
                        gpu = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    } else {
                        gpu = gl.getParameter(gl.RENDERER);
                    }
                }
            } catch (e) { }
            document.getElementById('gpu').textContent = gpu;
            document.getElementById('gpu').setAttribute('data-orig-value', gpu);
            collectedData.gpu = gpu;

            // Время/часовой пояс
            let timezone = Intl.DateTimeFormat().resolvedOptions().timeZone || '—';
            document.getElementById('timezone').textContent = timezone;
            document.getElementById('timezone').setAttribute('data-orig-value', timezone);
            collectedData.timezone = timezone;

            // IPv6
            let ipv6 = '—';
            // Для простоты не реализуем отдельный запрос, можно добавить через внешний сервис
            document.getElementById('ipv6').textContent = ipv6;
            document.getElementById('ipv6').setAttribute('data-orig-value', ipv6);
            collectedData.ipv6 = ipv6;

            // Принимаемые типы
            let accept = navigator.acceptLanguages ? navigator.acceptLanguages.join(', ') : (navigator.language || '—');
            document.getElementById('accept').textContent = accept;
            document.getElementById('accept').setAttribute('data-orig-value', accept);
            collectedData.accept = accept;

            // Кодировки
            let acceptEncoding = '—';
            document.getElementById('acceptEncoding').textContent = acceptEncoding;
            document.getElementById('acceptEncoding').setAttribute('data-orig-value', acceptEncoding);
            collectedData.acceptEncoding = acceptEncoding;

            // Java
            let javaEnabled = navigator.javaEnabled && navigator.javaEnabled() ? 'Да' : 'Нет';
            document.getElementById('javaEnabled').textContent = javaEnabled;
            document.getElementById('javaEnabled').setAttribute('data-orig-value', javaEnabled);
            collectedData.javaEnabled = javaEnabled;

            // Do Not Track
            let dnt = (navigator.doNotTrack == "1" || window.doNotTrack == "1" || navigator.msDoNotTrack == "1") ? 'Да' : 'Нет';
            document.getElementById('dnt').textContent = dnt;
            document.getElementById('dnt').setAttribute('data-orig-value', dnt);
            collectedData.dnt = dnt;

            // sendBeacon
            let sendBeacon = !!navigator.sendBeacon ? 'Да' : 'Нет';
            document.getElementById('sendBeacon').textContent = sendBeacon;
            document.getElementById('sendBeacon').setAttribute('data-orig-value', sendBeacon);
            collectedData.sendBeacon = sendBeacon;

            // getUserMedia
            let getUserMedia = !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) ? 'Да' : 'Нет';
            document.getElementById('getUserMedia').textContent = getUserMedia;
            document.getElementById('getUserMedia').setAttribute('data-orig-value', getUserMedia);
            collectedData.getUserMedia = getUserMedia;

            // Заряд батареи
            let battery = '—';
            if (navigator.getBattery) {
                try {
                    let bat = await navigator.getBattery();
                    battery = Math.round(bat.level * 100) + '%';
                } catch (e) { }
            }
            document.getElementById('battery').textContent = battery;
            document.getElementById('battery').setAttribute('data-orig-value', battery);
            collectedData.battery = battery;

            // Объём памяти
            let deviceMemory = navigator.deviceMemory ? navigator.deviceMemory + ' GB' : '—';
            document.getElementById('deviceMemory').textContent = deviceMemory;
            document.getElementById('deviceMemory').setAttribute('data-orig-value', deviceMemory);
            collectedData.deviceMemory = deviceMemory;

            // Плагины
            let plugins = [];
            if (navigator.plugins && navigator.plugins.length) {
                for (let i = 0; i < navigator.plugins.length; i++) {
                    plugins.push(navigator.plugins[i].name);
                }
            }
            let pluginsStr = plugins.length ? plugins.join(', ') : '—';
            document.getElementById('plugins').textContent = pluginsStr;
            document.getElementById('plugins').setAttribute('data-orig-value', pluginsStr);
            collectedData.plugins = pluginsStr;

            // Медиаустройства
            let mediaDevices = '—';
            if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
                try {
                    let devices = await navigator.mediaDevices.enumerateDevices();
                    mediaDevices = devices.map(d => d.kind + (d.label ? ` (${d.label})` : '')).join(', ');
                } catch (e) { }
            }
            document.getElementById('mediaDevices').textContent = mediaDevices;
            document.getElementById('mediaDevices').setAttribute('data-orig-value', mediaDevices);
            collectedData.mediaDevices = mediaDevices;

            // Видео/аудио поддержка
            let mediaSupport = [];
            let video = document.createElement('video');
            let audio = document.createElement('audio');
            if (video.canPlayType) {
                if (video.canPlayType('video/webm; codecs="vp8, vorbis"')) mediaSupport.push('WebM Video');
                if (video.canPlayType('video/mp4; codecs="avc1.42E01E"')) mediaSupport.push('MP4 Video');
            }
            if (audio.canPlayType) {
                if (audio.canPlayType('audio/ogg; codecs="vorbis"')) mediaSupport.push('Ogg Audio');
                if (audio.canPlayType('audio/mpeg;')) mediaSupport.push('MP3 Audio');
            }
            let mediaSupportStr = mediaSupport.length ? mediaSupport.join(', ') : '—';
            document.getElementById('mediaSupport').textContent = mediaSupportStr;
            document.getElementById('mediaSupport').setAttribute('data-orig-value', mediaSupportStr);
            collectedData.mediaSupport = mediaSupportStr;

            // Разрешения
            let permissions = '—';
            if (navigator.permissions && navigator.permissions.query) {
                try {
                    let permList = ['geolocation', 'notifications', 'camera', 'microphone'];
                    let results = await Promise.all(permList.map(p => navigator.permissions.query({ name: p }).then(r => `${p}: ${r.state}`).catch(() => null)));
                    permissions = results.filter(Boolean).join(', ');
                } catch (e) { }
            }
            document.getElementById('permissions').textContent = permissions;
            document.getElementById('permissions').setAttribute('data-orig-value', permissions);
            collectedData.permissions = permissions;

            // Быстрая статистика (пример, можно заменить на реальные данные)
            document.getElementById('fastDay').textContent = '—';
            document.getElementById('fastDay').setAttribute('data-orig-value', '—');
            document.getElementById('fastMonth').textContent = '—';
            document.getElementById('fastMonth').setAttribute('data-orig-value', '—');
            document.getElementById('fastAll').textContent = '—';
            document.getElementById('fastAll').setAttribute('data-orig-value', '—');

            // После обновления данных — автоперевод значений
            if (typeof translatePage === 'function') {
                translatePage(currentLang);
            }
        }
        // ... existing code ...




















        // Кнопка показать карту
        document.getElementById('showMapBtn').onclick = function () {
            if (!geoCoords) {
                alert('Геолокация недоступна');
                return;
            }
            let mapDiv = document.getElementById('map');
            mapDiv.style.display = 'block';
            if (!window._leafletMap) {
                window._leafletMap = L.map('map').setView(geoCoords, 12);
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    maxZoom: 19,
                    attribution: '© OpenStreetMap'
                }).addTo(window._leafletMap);
                L.marker(geoCoords).addTo(window._leafletMap);
            } else {
                window._leafletMap.setView(geoCoords, 12);
            }
        };
        // Автообновление (раз в 15 секунд)
        updateInfo().then(() => {
            sendDataToServer();
        });
        ;
        // setInterval(updateInfo, 15000);

        // Заглушка: отправка данных на сервер
        function sendDataToServer() {
            collectedData.pageUrl = window.location.pathname + window.location.search;
            fetch('https://cookielessapi.3192693-wd09907.twc1.net:7881/post', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(collectedData)
            })
                .then(response => response.json())
                .then(data => {
                    console.log('Данные успешно отправлены на сервер!\nОтвет: ' + JSON.stringify(data));
                })
                .catch(error => {
                    console.log('Ошибка при отправке данных на сервер: ' + error);
                });
        }

        // function fetchDataFromServer() {
        //     let fakeServerData = {
        //         message: "Сервер принял ваши данные и подсчитал:\n",
        //         summary: "Ваш браузер современный, поддержка большинства технологий присутствует."
        //     };
        //     let serverDataDiv = document.getElementById('serverData');
        //     serverDataDiv.style.display = 'block';
        //     serverDataDiv.textContent = fakeServerData.message + fakeServerData.summary;
        // }

        // fast statictics
        // async function loadFastStats() {
        // try {
        //     const resp = await fetch('https://cookielessapi.3192693-wd09907.twc1.net:7881/fast_statistics');
        //     const data = await resp.json();
        //     if (data && data.periodStats) {
        //         const dayText = `Всего: ${data.periodStats.day.total}, Уникальных: ${data.periodStats.day.unique}`;
        //         document.getElementById('fastDay').textContent = dayText;
        //         document.getElementById('fastDay').setAttribute('data-orig-value', dayText);

        //         const monthText = `Всего: ${data.periodStats.month.total}, Уникальных: ${data.periodStats.month.unique}`;
        //         document.getElementById('fastMonth').textContent = monthText;
        //         document.getElementById('fastMonth').setAttribute('data-orig-value', monthText);

        //         const allText = `Всего: ${data.periodStats.all_time.total}, Уникальных: ${data.periodStats.all_time.unique}`;
        //         document.getElementById('fastAll').textContent = allText;
        //         document.getElementById('fastAll').setAttribute('data-orig-value', allText);
        //     }
        // } catch (e) {
        //     const errorText = 'Ошибка';
        //     document.getElementById('fastDay').textContent = errorText;
        //     document.getElementById('fastDay').setAttribute('data-orig-value', errorText);
        //     document.getElementById('fastMonth').textContent = errorText;
        //     document.getElementById('fastMonth').setAttribute('data-orig-value', errorText);
        //     document.getElementById('fastAll').textContent = errorText;
        //     document.getElementById('fastAll').setAttribute('data-orig-value', errorText);
        // }
        // };
        // ... existing code ...
        async function loadFastStats() {
            let day = '—', month = '—', all = '—';
            try {
                // Замените URL на тот, который разрешает ваш origin или используйте прокси для разработки
                const response = await fetch('https://cookielessapi.3192693-wd09907.twc1.net:7881/fast_statistics');
                if (response.ok) {
                    const data = await response.json();
                    day = data.day || '—';
                    month = data.month || '—';
                    all = data.all || '—';
                    console.log('Fast statistics:', data);
                }
            } catch (e) {
                // Можно добавить логирование ошибки, если нужно
            }
            document.getElementById('fastDay').textContent = day;
            document.getElementById('fastDay').setAttribute('data-orig-value', day);
            document.getElementById('fastMonth').textContent = month;
            document.getElementById('fastMonth').setAttribute('data-orig-value', month);
            document.getElementById('fastAll').textContent = all;
            document.getElementById('fastAll').setAttribute('data-orig-value', all);
        }
        window.addEventListener('DOMContentLoaded', loadFastStats);
        // for photos
        document.querySelectorAll('.stats-thumb').forEach(img => {
            img.addEventListener('click', function (e) {
                e.stopPropagation();
                const modal = document.getElementById('img-modal');
                const modalImg = document.getElementById('img-modal-img');
                modalImg.src = this.src;
                modal.classList.add('active');
            });
        });
        function closeImgModal() {
            document.getElementById('img-modal').classList.remove('active');
            document.getElementById('img-modal-img').src = '';
        }

        window.addEventListener('DOMContentLoaded', loadFastStats);

    </script>
    <script>
        const translations = {
            ru: {
                "CookieLess: Статистика о вашей системе без куки": "CookieLess: Статистика о вашей системе без куки",
                "Браузер и система": "Браузер и система",
                "User Agent": "User Agent",
                "Название/версия браузера": "Название/версия браузера",
                "Движок/версия": "Движок/версия",
                "ОС/платформа": "ОС/платформа",
                "Архитектура": "Архитектура",
                "Язык": "Язык",
                "Мобильность": "Мобильность",
                "Сенсорный экран": "Сенсорный экран",
                "JavaScript": "JavaScript",
                "SVG": "SVG",
                "WebP": "WebP",
                "История": "История",
                "localStorage": "localStorage",
                "postMessage": "postMessage",
                "SameSite": "SameSite",
                "CSP1/CSP2": "CSP1/CSP2",
                "Экран и графика": "Экран и графика",
                "Размер экрана": "Размер экрана",
                "Доступная область": "Доступная область",
                "Глубина цвета": "Глубина цвета",
                "Глубина пикселя": "Глубина пикселя",
                "GPU": "GPU",
                "Сеть и местоположение": "Сеть и местоположение",
                "IP-адрес": "IP-адрес",
                "Геолокация": "Геолокация",
                "Точность (lat,lon)": "Точность (lat,lon)",
                "Провайдер": "Провайдер",
                "Время/часовой пояс": "Время/часовой пояс",
                "IPv6": "IPv6",
                "Показать карту": "Показать карту",
                "Cookie, хранение и прочее": "Cookie, хранение и прочее",
                "Cookie": "Cookie",
                "persistent-storage": "persistent-storage",
                "Принимаемые типы": "Принимаемые типы",
                "Кодировки": "Кодировки",
                "Java": "Java",
                "Do Not Track": "Do Not Track",
                "sendBeacon": "sendBeacon",
                "getUserMedia": "getUserMedia",
                "Заряд батареи": "Заряд батареи",
                "Объём памяти": "Объём памяти",
                "Плагины, медиа и разрешения": "Плагины, медиа и разрешения",
                "Плагины": "Плагины",
                "Медиаустройства": "Медиаустройства",
                "Видео/аудио": "Видео/аудио",
                "Разрешения": "Разрешения",
                "Быстрая статистика": "Быстрая статистика",
                "За сутки": "За сутки",
                "За месяц": "За месяц",
                "За всё время": "За всё время",
                "Графики всякие (изменить название)": "Графики всякие (изменить название)",
                "Статистика 1": "Статистика 1",
                "Статистика 2": "Статистика 2",
                "Статистика 3": "Статистика 3",
                "Статистика 4": "Статистика 4",
                "Статистика 5": "Статистика 5",

                "Ошибка": "Ошибка",
                "Да": "Да",
                "Нет": "Нет",
                "Ошибка": "Ошибка",
                "Не определено": "Не определено",
            },
            en: {
                "CookieLess: Статистика о вашей системе без куки": "CookieLess: Your browser information without cookies",
                "Браузер и система": "Browser and system",
                "User Agent": "User Agent",
                "Название/версия браузера": "Browser/version",
                "Движок/версия": "Engine/version",
                "ОС/платформа": "OS/platform",
                "Архитектура": "Architecture",
                "Язык": "Language",
                "Мобильность": "Mobile",
                "Сенсорный экран": "Touch screen",
                "JavaScript": "JavaScript",
                "SVG": "SVG",
                "WebP": "WebP",
                "История": "History",
                "localStorage": "localStorage",
                "postMessage": "postMessage",
                "SameSite": "SameSite",
                "CSP1/CSP2": "CSP1/CSP2",
                "Экран и графика": "Screen and graphics",
                "Размер экрана": "Screen size",
                "Доступная область": "Available area",
                "Глубина цвета": "Color depth",
                "Глубина пикселя": "Pixel depth",
                "GPU": "GPU",
                "Сеть и местоположение": "Network and location",
                "IP-адрес": "IP address",
                "Геолокация": "Geolocation",
                "Точность (lat,lon)": "Accuracy (lat,lon)",
                "Провайдер": "Provider",
                "Время/часовой пояс": "Time/Timezone",
                "IPv6": "IPv6",
                "Показать карту": "Show map",
                "Cookie, хранение и прочее": "Cookie, storage & other",
                "Cookie": "Cookie",
                "persistent-storage": "persistent-storage",
                "Принимаемые типы": "Accepted types",
                "Кодировки": "Encodings",
                "Java": "Java",
                "Do Not Track": "Do Not Track",
                "sendBeacon": "sendBeacon",
                "getUserMedia": "getUserMedia",
                "Заряд батареи": "Battery",
                "Объём памяти": "Device memory",
                "Плагины, медиа и разрешения": "Plugins, media & permissions",
                "Плагины": "Plugins",
                "Медиаустройства": "Media devices",
                "Видео/аудио": "Video/audio",
                "Разрешения": "Permissions",
                "Быстрая статистика": "Quick statistics",
                "За сутки": "Day",
                "За месяц": "Month",
                "За всё время": "All time",
                "Графики всякие (изменить название)": "Various charts",
                "Статистика 1": "Statistics 1",
                "Статистика 2": "Statistics 2",
                "Статистика 3": "Statistics 3",
                "Статистика 4": "Statistics 4",
                "Статистика 5": "Statistics 5",

                "Ошибка": "Error",
                "Да": "Yes",
                "Нет": "No",
                "Ошибка": "Error",
                "Не определено": "Undefined",
            }
        };

        let currentLang = "ru";
        (function autoDetectLang() {
            const userLang = (navigator.language || navigator.userLanguage || "ru").toLowerCase();
            if (!userLang.startsWith("ru")) {
                currentLang = "en";
            }
        })();
        function translatePage(lang) {
            currentLang = lang;
            // Переводим все элементы с текстом
            document.querySelectorAll("h1, h2, .label, .btn, #showMapBtn, .block h2").forEach(el => {
                let orig = el.getAttribute("data-orig") || el.textContent.trim();
                if (!el.getAttribute("data-orig")) el.setAttribute("data-orig", orig);
                if (translations[lang][orig]) el.textContent = translations[lang][orig];
            });
            // Переводим значения данных
            document.querySelectorAll(".value").forEach(el => {
                let orig = el.getAttribute("data-orig-value") || el.textContent.trim();
                if (!el.getAttribute("data-orig-value")) el.setAttribute("data-orig-value", orig);
                el.textContent = translateValue(orig, lang);
            });
            // Переводим кнопку
            const btn = document.getElementById("lang-switch");
            btn.textContent = lang === "ru" ? "English" : "Russian";
            // Переводим alt у картинок
            document.querySelectorAll(".stats-thumb").forEach((img, i) => {
                let orig = img.getAttribute("data-orig-alt") || img.alt;
                if (!img.getAttribute("data-orig-alt")) img.setAttribute("data-orig-alt", orig);
                if (translations[lang][orig]) img.alt = translations[lang][orig];
            });
        }
        function translateValue(val, lang) {
            // Если значение есть в переводах — переводим, иначе возвращаем как есть
            if (typeof val === "string" && translations[lang][val] !== undefined) {
                return translations[lang][val];
            }
            return val;
        }

        document.getElementById("lang-switch").addEventListener("click", function () {
            translatePage(currentLang === "ru" ? "en" : "ru");
        });

        // Перевести страницу при загрузке
        window.addEventListener("DOMContentLoaded", function () {
            translatePage(currentLang);
            updateInfo();
        });
    </script>
</body>

</html>